% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/angle_calculation.R
\name{treeangle}
\alias{treeangle}
\title{Calculate angles from Tree-Structured Data with Generation-Dependent Normalization}
\usage{
treeangle(
  data,
  alpha = 0.95,
  method = "mean",
  start = c(0, 0),
  normalize = TRUE,
  target_sd = 0.01,
  tau = 0.1
)
}
\arguments{
\item{data}{Input data. Can be one of two formats:
\itemize{
  \item **List**: A list of length \eqn{T}, where \code{data[[i]]} is a matrix or data frame
        of 2 columns (X, Y) representing the data for generation \eqn{i}.
        (This matches the structure of the simulation code in the original study).
  \item **Matrix/Data Frame**: Must have 3 columns (X, Y, Generation) if \code{normalize = TRUE}.
        The 3rd column must contain integers indicating the generation index.
}}

\item{alpha}{Numeric value between 0 and 1 specifying the quantile threshold (default = 0.95).
This determines the size of the quantile ellipse (filtering top 5\% outliers).}

\item{method}{Character string specifying the angle calculation method.
Options: "min", "median", "equal", "mean", "neigh" (default = "mean").
The paper recommends "mean" for robust estimation.}

\item{start}{Numeric vector of length 2 specifying the starting point coordinates (default = c(0,0)).}

\item{normalize}{Logical. Whether to perform the generation-dependent normalization (default = TRUE).
If TRUE, the function applies scaling and shifting logic to standardize distributions across generations.}

\item{target_sd}{Numeric value. The target standard deviation after normalization (default = 0.01).
Corresponds to the \code{sqrt(0.0001)} term in the original algorithm.}

\item{tau}{Numeric value. A hyperparameter controlling the step size of the mean shift across generations (default = 0.1).
Larger values separate the generations further apart from the origin.
Corresponds to the coefficient for the harmonic series sum \eqn{\sum (1/k)} in the algorithm.}
}
\value{
A matrix containing angle information, point coordinates, and coefficients for the selected method.
}
\description{
This function calculates the Minimal Enclosing Angle from 2D data points.
It includes a specialized normalization step designed for tree-structured data,
strictly following the TD-DeltaTheta algorithm (Algorithm 1 in the paper).
This involves scaling based on the last generation's variance and shifting means
dynamically based on the generation depth.
}
\examples{
\dontrun{
# --- Scenario 1: Input as a List (Matches original simulation) ---
set.seed(123)
data_list <- list()
# Gen 1
data_list[[1]] <- matrix(rnorm(100), ncol=2)
# Gen 2
data_list[[2]] <- matrix(rnorm(100, mean=2), ncol=2)

# Calculate with normalization (Auto-detects generation by list index)
res_list <- treeangle(data_list, normalize = TRUE, tau = 0.1)

# --- Scenario 2: Input as a Matrix with Generation Column ---
data_mat <- rbind(
  cbind(data_list[[1]], 1), # Col 3 is Gen
  cbind(data_list[[2]], 2)
)

res_mat <- treeangle(data_mat, normalize = TRUE)
}

}
